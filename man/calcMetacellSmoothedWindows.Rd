% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metacells.R
\name{calcMetacellSmoothedWindows}
\alias{calcMetacellSmoothedWindows}
\title{calcMetacellSmoothedWindows}
\usage{
calcMetacellSmoothedWindows(
  original_obj,
  metacell_obj,
  type = "CG",
  threads = 1,
  step = 500,
  smooth = 3,
  genome = "hg38",
  index = "chr_cg",
  futureType = "multicore",
  returnSumMatrix = TRUE,
  returnPctMatrix = TRUE,
  chrList = NULL,
  verbose = TRUE
)
}
\arguments{
\item{original_obj}{Amethyst single-cell object with valid @h5paths and @index.}

\item{metacell_obj}{Metacell object from makeMetacells() with metadata$originating_cellIDs.}

\item{type}{Methylation context ("CG" or "CH"; default "CG").}

\item{threads}{Parallel workers for H5 reading.}

\item{step}{Window width in bp.}

\item{smooth}{Rolling window size (odd integer; centered).}

\item{genome}{Genome identifier (currently unused; kept for compatibility).}

\item{index}{Name of chr index in @index (default "chr_cg").}

\item{futureType}{"multicore" or "multisession" for future.}

\item{returnSumMatrix}{Return c/t matrices (TRUE/FALSE).}

\item{returnPctMatrix}{Return \%m matrix (TRUE/FALSE).}

\item{chrList}{Optional whitelist of chromosomes.}

\item{verbose}{Print progress.}
}
\value{
Either a list(sum_matrix, pct_matrix), or a single data.table depending on flags.
}
\description{
Aggregate c and t observations for metacells across smoothed genomic windows,
computing one metacell at a time (memory-efficient).
}
