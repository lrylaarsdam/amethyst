% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metacells.R
\name{metaMap}
\alias{metaMap}
\title{metaMap}
\usage{
metaMap(
  obj,
  track = NULL,
  genes = NULL,
  regions = NULL,
  colors = NULL,
  trackOverhang = 5000,
  arrowOverhang = 3000,
  legend = TRUE,
  removeNA = TRUE,
  trackScale = 0.07,
  arrowScale = NULL,
  colorMax = NULL,
  order = NULL,
  nrow = max(length(genes), length(regions)),
  clusterRows = TRUE,
  clusterMethod = "ward.D2",
  clusterScope = "local",
  extraTracks = NULL,
  extraTrackColors = NULL,
  remove = NULL
)
}
\arguments{
\item{obj}{Amethyst object containing metacell methylation matrices in @tracks and a gene annotation in @ref.}

\item{track}{Name of the matrix in @tracks containing methylation values.}

\item{genes}{Gene list to plot.}

\item{regions}{Optional genomic regions to plot (e.g. "chr1_1000_2000").}

\item{colors}{Optional custom color palette.}

\item{trackOverhang}{Number of bp to extend beyond the gene on each side.}

\item{arrowOverhang}{Number of bp arrow extends beyond gene body.}

\item{legend}{Logical; include legend.}

\item{removeNA}{Logical; drop non-finite values before plotting.}

\item{trackScale}{Scale for gene track height.}

\item{arrowScale}{Manual arrow size (NULL = auto).}

\item{colorMax}{Upper bound on color scale (NULL = auto).}

\item{order}{Optional manual order of metacell rows.}

\item{nrow}{Number of rows in multi-gene layout.}

\item{clusterRows}{Logical; cluster metacell rows.}

\item{clusterMethod}{Linkage method for hclust.}

\item{clusterScope}{"local" (per gene) or "global" (shared order).}

\item{extraTracks}{Optional named list of coordinate tracks to show below gene body.}

\item{extraTrackColors}{Optional colors for extraTracks.}

\item{remove}{Optional regex to remove genes from obj@ref by name.}
}
\value{
A grid of ggplot objects arranged with gridExtra::grid.arrange().
}
\description{
Plot methylation levels for metacells aggregated across genes or regions,
with optional hierarchical clustering of metacell rows (local or global) and gene models.
}
